# 第9章 微分几何在机器人中的应用

## 9.1 机器人运动学建模

### 9.1.1 机器人构型空间的流形结构

机器人的构型空间（Configuration Space）是所有可能位形的集合。对于不同的机器人，构型空间具有不同的流形结构。

**定义 9.1（构型空间）** 机器人的**构型空间** $\mathcal{C}$ 是所有可能构型的集合。每个构型 $q \in \mathcal{C}$ 唯一确定了机器人所有点的位置。

**例 9.1（平面移动机器人）** 平面上的移动机器人的构型为 $(x, y, \theta)$，其中 $(x, y)$ 是位置，$\theta$ 是朝向。构型空间为：
$$\mathcal{C} = \mathbb{R}^2 \times S^1 = SE(2)$$

**例 9.2（机械臂）** 具有 $n$ 个旋转关节的机械臂，构型空间为：
$$\mathcal{C} = T^n = (S^1)^n$$

即 $n$ 维环面。

**例 9.3（刚体）** 三维空间中刚体的构型空间为：
$$\mathcal{C} = SE(3) = \mathbb{R}^3 \times SO(3)$$

### 9.1.2 正运动学和逆运动学的几何表示

**正运动学**（Forward Kinematics）是从关节空间到工作空间的映射。

**定义 9.2（正运动学）** 对于机械臂，**正运动学**是映射 $FK: \mathcal{C} \to SE(3)$：
$$FK(q) = T_n^0(q)$$

其中 $T_n^0$ 是末端执行器相对于基座的位姿。

使用李群表示，对于串联机械臂：
$$T_n^0(q) = e^{\xi_1 q_1} e^{\xi_2 q_2} \cdots e^{\xi_n q_n} T_n^0(0)$$

其中 $\xi_i$ 是第 $i$ 个关节的运动旋量。

**逆运动学**（Inverse Kinematics）是从工作空间到关节空间的映射。

**定义 9.3（逆运动学）** **逆运动学**求解：
$$q = IK(T)$$

使得 $FK(q) = T$。

**几何解释**：逆运动学可以看作是在构型空间流形上寻找满足末端约束的点的几何问题。

### 9.1.3 冗余机器人的运动学分析

**定义 9.4（冗余度）** 机械臂的**冗余度**为：
$$r = n - m$$

其中 $n$ 是关节数，$m$ 是任务空间维数。

**零空间运动**：对于冗余机器人，存在满足末端约束的无穷多解。这些解构成**零空间**（Null Space）。

**定义 9.5（零空间）** 雅可比矩阵 $J$ 的**零空间**为：
$$\mathcal{N}(J) = \{\dot{q} : J\dot{q} = 0\}$$

零空间中的运动不改变末端位姿，可用于优化其他目标（如避障、奇异位形避免等）。

## 9.2 机器人动力学建模

### 9.2.1 拉格朗日力学在流形上的推广

**定义 9.6（拉格朗日函数）** 在构型空间 $\mathcal{C}$ 上，**拉格朗日函数**为：
$$L(q, \dot{q}) = T(q, \dot{q}) - V(q)$$

其中 $T$ 是动能，$V$ 是势能。

**定理 9.1（欧拉-拉格朗日方程）** 运动方程为：
$$\frac{d}{dt}\frac{\partial L}{\partial \dot{q}^i} - \frac{\partial L}{\partial q^i} = \tau_i$$

其中 $\tau_i$ 是广义力。

**黎曼几何解释**：动能可以表示为：
$$T = \frac{1}{2} \dot{q}^T M(q) \dot{q} = \frac{1}{2} g_{ij}(q) \dot{q}^i \dot{q}^j$$

其中 $M(q)$ 是质量矩阵，$g_{ij}$ 是构型空间上的黎曼度量。

**克里斯托费尔形式**：欧拉-拉格朗日方程可以写成：
$$M(q)\ddot{q} + C(q, \dot{q})\dot{q} + G(q) = \tau$$

其中 $C(q, \dot{q})$ 包含克里斯托费尔符号项。

### 9.2.2 哈密顿力学和辛几何

**定义 9.7（广义动量）** **广义动量**定义为：
$$p_i = \frac{\partial L}{\partial \dot{q}^i} = g_{ij}\dot{q}^j$$

**定义 9.8（哈密顿函数）** **哈密顿函数**为：
$$H(q, p) = p^T \dot{q} - L(q, \dot{q}) = T + V$$

**哈密顿方程**：
$$\dot{q}^i = \frac{\partial H}{\partial p_i}, \quad \dot{p}_i = -\frac{\partial H}{\partial q^i} + \tau_i$$

**辛几何解释**：相空间 $T^*\mathcal{C}$（余切丛）具有自然的**辛结构** $\omega = dp_i \wedge dq^i$。哈密顿流保持辛形式不变。

### 9.2.3 机器人动力学的几何方法

**测地线方程**：在无外力情况下，机器人沿构型空间的测地线运动：
$$\ddot{q}^k + \Gamma^k_{ij}\dot{q}^i\dot{q}^j = 0$$

**几何控制**：利用构型空间的黎曼几何设计控制器。

## 9.3 机器人控制中的几何方法

### 9.3.1 几何控制的基本概念

**定义 9.9（分布）** 构型空间上的**分布** $\mathcal{D}$ 是对每点 $q \in \mathcal{C}$ 指定一个子空间 $\mathcal{D}_q \subset T_q\mathcal{C}$ 的映射。

**非完整约束**：许多移动机器人受到非完整约束：
$$\omega_i(q)\dot{q} = 0, \quad i = 1, \ldots, k$$

这些约束定义了切空间的一个分布。

**可控性**：Chow定理给出了非完整系统的可控性判据。

### 9.3.2 姿态控制的几何方法

**定义 9.10（姿态误差）** 对于期望姿态 $R_d \in SO(3)$ 和当前姿态 $R \in SO(3)$，定义**姿态误差**为：
$$R_e = R_d^T R \in SO(3)$$

**几何PD控制**：
$$\tau = -K_p \text{ vee}(R_e - R_e^T) - K_d \omega$$

其中 $\text{vee}: \mathfrak{so}(3) \to \mathbb{R}^3$ 是逆映射。

### 9.3.3 轨迹跟踪的几何控制

**定义 9.11（跟踪误差）** 对于期望轨迹 $q_d(t)$，定义**跟踪误差**：
$$e = q - q_d$$

**几何控制器设计**：
$$\tau = M(q)(\ddot{q}_d - K_v \dot{e} - K_p e) + C(q, \dot{q})\dot{q} + G(q)$$

**基于测地线的规划**：在构型空间中，沿测地线规划轨迹对应于"最自然"的运动。

## 9.4 本章小结

本章介绍了微分几何在机器人学中的应用：

1. **运动学建模**：构型空间的流形结构，正逆运动学的几何解释
2. **动力学建模**：拉格朗日和哈密顿力学的几何形式
3. **几何控制**：利用流形结构设计控制器

微分几何为机器人学提供了统一的数学框架，使得运动规划、控制和优化问题可以在几何视角下得到深入理解。

## 9.5 参考文献

1. Murray, R. M., Li, Z., & Sastry, S. S. (1994). *A Mathematical Introduction to Robotic Manipulation*. CRC Press.
2. Bullo, F., & Lewis, A. D. (2005). *Geometric Control of Mechanical Systems*. Springer.
3. Park, F. C. (1991). The optimal kinematic design of mechanisms. Ph.D. thesis, Harvard University.

## 9.6 练习题

1. 描述平面移动机器人构型空间 $SE(2)$ 的流形结构。

2. 对于二连杆机械臂，推导正运动学的李群表示。

3. 解释冗余机器人零空间运动的几何意义。

4. 证明质量矩阵 $M(q)$ 定义了构型空间上的黎曼度量。

5. 推导欧拉-拉格朗日方程的克里斯托费尔形式。

6. 设计一个基于李代数的姿态控制器。
