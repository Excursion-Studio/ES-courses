# ROS2 基础与进阶教程

## 课程目标

本课程旨在为机器人专业学生和开发者提供完整的 ROS2（Robot Operating System 2）开发技能，从基础概念到高级应用，涵盖单机开发、多机器人协作、空地协同和空中机械臂等前沿技术。通过本课程学习，学生将能够：

1. 掌握 ROS2 的核心概念和开发方法
2. 理解节点、话题、服务、参数、动作等通信机制
3. 熟悉机械臂、无人车、无人机的开发流程
4. 能够实现多机器人协作、空地协同和空中机械臂等复杂系统
5. 具备独立开发和部署机器人应用的能力

## 课程内容

### 第零部分：开发工具基础（4学时）

#### 第0章：开发工具基础

0.1 Linux 基础
- Linux 发行版选择和文件系统结构
- 常用命令：文件操作、权限管理、进程管理
- 环境变量配置

0.2 Shell 脚本
- Shell 基础语法和变量
- 条件判断和循环
- 函数定义和 ROS2 常用脚本

0.3 CMake 构建工具
- CMake 基本语法和编译目标
- ROS2 项目的 CMake 配置
- 自定义 CMake 模块

0.4 Docker 容器技术
- Docker 基础概念和安装
- Docker 基本命令和 ROS2 Dockerfile
- Docker Compose 多容器配置

### 第一部分：ROS2 基础（16学时）

#### 第1章：ROS2 概述与环境搭建（2学时）

1.1 ROS2 简介
- ROS2 的发展历程和架构
- ROS2 vs ROS1 对比
- 核心概念：节点、话题、服务、参数、动作

1.2 环境安装
- Ubuntu 安装 ROS2 Humble
- Windows 安装配置
- 开发环境配置

1.3 工作空间和功能包
- 创建工作空间
- 创建 Python/C++ 功能包
- 包管理与依赖

#### 第2章：节点（Node）（2学时）

2.1 节点概念
- 节点架构和特点
- 节点生命周期

2.2 创建节点
- 第一个 Python 节点
- 第一个 C++ 节点
- 生命周期节点

2.3 节点命令行工具
- ros2 node list/info
- 节点调试技巧

#### 第3章：话题（Topic）（2学时）

3.1 话题通信模型
- 发布者与订阅者
- 异步通信特点

3.2 标准消息类型
- 常用消息类型介绍
- 消息类型查看方法

3.3 自定义消息
- 创建 msg 文件
- 配置功能包
- 使用自定义消息

3.4 QoS（服务质量）
- QoS 策略和配置
- QoS 兼容性

#### 第4章：服务（Service）（2学时）

4.1 服务通信模型
- 服务端与客户端
- 同步通信特点

4.2 标准服务类型
- 常用服务类型
- 服务类型查看

4.3 自定义服务
- 创建 srv 文件
- 服务实现（Python/C++）

4.4 服务命令行工具
- ros2 service list/call

#### 第5章：参数（Parameter）（2学时）

5.1 参数系统概述
- 参数类型和特点
- 参数声明与获取

5.2 参数动态更新
- 参数回调机制
- 参数描述与约束

5.3 YAML 配置文件
- YAML 格式
- 加载配置文件

5.4 参数命令行工具
- ros2 param get/set/dump

#### 第6章：动作（Action）（2学时）

6.1 动作通信模型
- 目标、反馈、结果
- 长时间任务处理

6.2 动作定义
- 创建 action 文件
- 动作服务器与客户端

6.3 动作实现
- Python/C++ 实现
- 取消和反馈处理

6.4 动作命令行工具
- ros2 action list/send_goal

#### 第7章：工具与调试（4学时）

7.1 Launch 文件
- Python Launch 文件
- 命名空间和参数传递
- 包含其他 Launch 文件

7.2 ros2 命令行工具
- 节点、话题、服务、参数、动作命令
- 包管理和接口命令

7.3 rqt 可视化工具
- rqt_graph、rqt_plot、rqt_console
- RViz2 可视化

7.4 日志与调试
- 日志级别和配置
- 调试技巧和常见问题

### 第二部分：机器人平台开发（16学时）

#### 第8章：机械臂开发（4学时）

8.1 机械臂运动学基础
- 坐标系统和 DH 参数
- 正运动学与逆运动学

8.2 URDF 模型创建
- URDF 基本结构
- 6自由度机械臂 URDF
- Xacro 简化

8.3 MoveIt2 运动规划框架
- MoveIt2 架构和安装
- 配置 MoveIt2
- Python 接口

8.4 轨迹规划与执行
- 路径规划类型
- 轨迹规划示例

8.5 抓取与放置操作
- 抓取动作定义
- 抓取流程实现

#### 第9章：无人车开发（4学时）

9.1 无人车系统架构
- 系统组成和话题架构

9.2 导航2（Nav2）框架
- Nav2 架构和安装
- 配置文件
- 启动 Nav2

9.3 SLAM 建图
- SLAM 概述和安装
- SLAM Toolbox 配置
- 启动建图和保存地图

9.4 路径规划与避障
- 路径规划类型
- 导航客户端
- 简单避障控制器

9.5 定位与地图服务
- AMCL 定位
- 初始位姿设置

#### 第10章：无人机开发（4学时）

10.1 无人机系统架构
- 系统组成和话题架构

10.2 PX4 飞控集成
- PX4 简介和安装
- PX4-ROS2 桥接
- 启动仿真

10.3 仿真环境配置
- Gazebo 仿真
- 自定义世界文件

10.4 飞行控制
- 基本飞行控制节点
- 速度控制

10.5 任务规划
- 任务状态机
- 圆形轨迹飞行

10.6 传感器融合
- IMU 数据处理
- GPS 数据处理

#### 第11章：仿真与可视化（4学时）

11.1 Gazebo 仿真环境
- Gazebo 简介和安装
- 自定义世界
- Launch 文件启动

11.2 RViz2 可视化
- RViz2 简介和配置
- Marker 可视化

11.3 自定义插件开发
- Gazebo 插件结构
- CMake 配置

11.4 多机器人仿真
- 多机器人 Launch 配置
- 话题命名和 TF 树

11.5 传感器仿真
- 激光雷达、相机、IMU 仿真

### 第三部分：高级应用（12学时）

#### 第12章：多机器人协作（4学时）

12.1 多机器人系统概述
- 协作架构模式（集中式、分布式、混合式）
- ROS2 多机器人通信

12.2 任务分配系统
- 任务分配算法
- 基于拍卖的任务分配
- 机器人代理节点

12.3 编队控制
- 编队形状定义
- 虚拟结构法

12.4 冲突检测与解决
- 碰撞避免
- ORCA 算法

12.5 分布式共识
- 一致性协议

12.6 多机器人 Launch 配置

#### 第13章：空地协同（4学时）

13.1 空地协同系统概述
- 系统架构和协同模式
- ROS2 话题架构

13.2 协调中心设计
- 协调器节点
- 任务分配和状态管理

13.3 空中侦察与地面执行
- UAV 侦察节点（目标检测）
- UGV 执行节点

13.4 通信中继
- UAV 通信中继节点
- 扩展通信范围

13.5 协同建图
- 空地协同 SLAM
- 地图融合

13.6 空地协同 Launch 配置

#### 第14章：空中机械臂（4学时）

14.1 空中机械臂概述
- 系统组成和技术挑战
- 应用场景

14.2 系统建模
- 动力学模型
- URDF 模型

14.3 飞行控制与机械臂协调
- 协调控制器
- 任务分解控制

14.4 视觉伺服抓取
- 视觉伺服控制器
- 目标检测与位姿估计

14.5 抓取动作规划
- 抓取规划器
- 抓取序列（接近、下降、抓取、撤退）

14.6 空中机械臂 Launch 配置

14.7 安全与故障处理
- 安全监控节点
- 故障检测与紧急停止

## 实验环节

1. **实验一**：ROS2 基础实验（6学时）
   - 创建节点、话题、服务
   - 实现参数动态配置
   - 编写动作服务器和客户端

2. **实验二**：机器人平台实验（6学时）
   - 机械臂运动规划和抓取
   - 无人车导航和避障
   - 无人机飞行控制和任务规划

3. **实验三**：多机器人协作实验（6学时）
   - 实现多机器人任务分配
   - 编队控制和冲突避免
   - 空地协同和空中机械臂

## 推荐教材和参考资料

### 教材
1. 《ROS2 机器人开发从入门到实践》，张瑞雷，机械工业出版社
2. 《机器人学导论》，John J. Craig，机械工业出版社
3. 《概率机器人》，Sebastian Thrun，清华大学出版社

### 参考资料
1. [ROS2 官方文档](https://docs.ros.org/en/humble/)
2. [Nav2 文档](https://navigation.ros.org/)
3. [MoveIt2 文档](https://moveit.picknik.ai/)
4. [PX4 文档](https://docs.px4.io/)
5. [Gazebo 文档](https://gazebosim.org/)
6. [ROS Answers](https://answers.ros.org/)

## 联系我们
目前教程正处在框架搭建阶段、许多内容仅为走马观花，大量细节亟待完善。

展示用的SVG图为AI生成，看似精致，实则存在诸多问题，未来也将逐步完善。

如果您在学习过程中遇到任何问题，或者对教程的改进有任何建议，欢迎联系我们：

- Official Repository: [https://excursion-studio.github.io/ES-courses/](https://github.com/Excursion-Studio/ES-courses)
- Email: [excursion-studio@outlook.com](mailto:excursion-studio@outlook.com)
