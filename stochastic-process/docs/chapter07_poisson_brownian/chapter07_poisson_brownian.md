# 第7章 泊松过程与布朗运动

## 7.1 泊松过程的定义和性质

### 7.1.1 泊松过程的定义

泊松过程是随机过程中最重要的计数过程之一，广泛应用于排队论、可靠性工程、通信系统等领域。在机器人学中，泊松过程可以建模传感器事件的到达、故障的发生等。

**定义 7.1（计数过程）** 一个**计数过程** $\{N(t), t \geq 0\}$ 是一个随机过程，其中 $N(t)$ 表示到时间 $t$ 为止发生的事件数，满足：
1. $N(t) \geq 0$ 且取整数值
2. 若 $s < t$，则 $N(s) \leq N(t)$
3. 对于 $s < t$，$N(t) - N(s)$ 等于区间 $(s, t]$ 内发生的事件数

**定义 7.2（泊松过程）** 计数过程 $\{N(t), t \geq 0\}$ 称为具有速率 $\lambda > 0$ 的**泊松过程**，如果满足：

1. **独立增量性**：对于任意不相交的时间区间，其增量相互独立
2. **稀有性**：在很短的时间 $\Delta t$ 内，事件发生概率很小：
   $$P(N(t+\Delta t) - N(t) = 1) = \lambda \Delta t + o(\Delta t)$$
   $$P(N(t+\Delta t) - N(t) \geq 2) = o(\Delta t)$$
3. **初始条件**：$N(0) = 0$

**定理 7.1** 泊松过程的增量服从泊松分布：
$$P(N(t) - N(s) = k) = \frac{(\lambda(t-s))^k}{k!} e^{-\lambda(t-s)}, \quad k = 0, 1, 2, \ldots$$

**证明**：考虑小区间划分，利用独立增量性和稀有性，通过极限过程可证。

### 7.1.2 泊松过程的数字特征

**定理 7.2** 泊松过程 $N(t)$ 的期望和方差为：
$$E[N(t)] = \lambda t, \quad \text{Var}[N(t)] = \lambda t$$

**证明**：由泊松分布的性质直接得到。

**协方差函数**：对于 $s \leq t$，
$$\text{Cov}(N(s), N(t)) = \text{Var}[N(s)] = \lambda s$$

**自相关函数**：
$$R_N(s, t) = E[N(s)N(t)] = \lambda s + \lambda^2 st, \quad s \leq t$$

### 7.1.3 泊松过程的到达时间

**定义 7.3（到达时间）** 设 $S_n$ 是第 $n$ 个事件发生的时刻，称为**到达时间**（Arrival Time）或**等待时间**。

**定义 7.4（到达时间间隔）** 设 $T_n = S_n - S_{n-1}$（其中 $S_0 = 0$）为第 $n-1$ 个事件与第 $n$ 个事件之间的**到达时间间隔**（Inter-arrival Time）。

**定理 7.3** 泊松过程的到达时间间隔 $T_1, T_2, \ldots$ 是独立同分布的指数随机变量，参数为 $\lambda$：
$$P(T_n > t) = e^{-\lambda t}, \quad t \geq 0$$

**证明**：利用泊松过程的无记忆性。

**定理 7.4** 第 $n$ 个到达时间 $S_n$ 服从伽马分布 $\Gamma(n, \lambda)$，其概率密度函数为：
$$f_{S_n}(t) = \frac{\lambda^n t^{n-1}}{(n-1)!} e^{-\lambda t}, \quad t \geq 0$$

### 7.1.4 泊松过程的叠加和分解

**定理 7.5（叠加定理）** 设 $N_1(t)$ 和 $N_2(t)$ 是两个独立的泊松过程，速率分别为 $\lambda_1$ 和 $\lambda_2$。则 $N(t) = N_1(t) + N_2(t)$ 是速率为 $\lambda_1 + \lambda_2$ 的泊松过程。

**定理 7.6（分解定理）** 设 $N(t)$ 是速率为 $\lambda$ 的泊松过程，每个事件以概率 $p$ 被标记为类型1，以概率 $1-p$ 被标记为类型2。则类型1事件形成速率为 $\lambda p$ 的泊松过程，类型2事件形成速率为 $\lambda(1-p)$ 的泊松过程，且这两个过程相互独立。

## 7.2 非齐次泊松过程

### 7.2.1 非齐次泊松过程的定义

在实际应用中，事件发生的速率可能随时间变化，这就需要非齐次泊松过程。

**定义 7.5（非齐次泊松过程）** 计数过程 $\{N(t), t \geq 0\}$ 称为具有**强度函数** $\lambda(t) > 0$ 的**非齐次泊松过程**，如果满足：

1. **独立增量性**
2. **稀有性**：$P(N(t+\Delta t) - N(t) = 1) = \lambda(t) \Delta t + o(\Delta t)$
3. **初始条件**：$N(0) = 0$

**定理 7.7** 非齐次泊松过程的增量服从泊松分布：
$$P(N(t) - N(s) = k) = \frac{\left(\int_s^t \lambda(u) du\right)^k}{k!} e^{-\int_s^t \lambda(u) du}$$

**定义 7.6（均值函数）** 定义**均值函数**为：
$$\Lambda(t) = \int_0^t \lambda(u) du$$

则 $E[N(t)] = \Lambda(t)$。

### 7.2.2 非齐次泊松过程的变换

**定理 7.8（时间变换）** 设 $N(t)$ 是速率为1的齐次泊松过程，$\Lambda(t)$ 是连续递增函数。则 $\tilde{N}(t) = N(\Lambda(t))$ 是具有均值函数 $\Lambda(t)$ 的非齐次泊松过程。

**定理 7.9（逆变换）** 设 $\tilde{N}(t)$ 是具有均值函数 $\Lambda(t)$ 的非齐次泊松过程。定义 $N(s) = \tilde{N}(\Lambda^{-1}(s))$，则 $N(s)$ 是速率为1的齐次泊松过程。

### 7.2.3 在机器人中的应用

**例 7.1（传感器事件建模）** 机器人在不同区域活动时，传感器触发事件的速率可能不同。设机器人在区域 $i$ 时，传感器事件速率为 $\lambda_i$。则整体事件过程可以用分段常数的强度函数建模。

**例 7.2（故障预测）** 机器人部件的故障率可能随使用时间增加（老化）。可以用 $\lambda(t) = \lambda_0 e^{\alpha t}$ 建模递增的故障率。

## 7.3 布朗运动的定义和性质

### 7.3.1 布朗运动的定义

布朗运动（Brownian Motion）是数学中最重要的连续时间随机过程之一，由罗伯特·布朗观察花粉颗粒运动而得名，由爱因斯坦和维纳等人建立数学理论。

**定义 7.7（标准布朗运动）** 随机过程 $\{B(t), t \geq 0\}$ 称为**标准布朗运动**（或**维纳过程**），如果满足：

1. **初始条件**：$B(0) = 0$
2. **独立增量性**：对于 $0 \leq t_1 < t_2 < \cdots < t_n$，增量 $B(t_2)-B(t_1), \ldots, B(t_n)-B(t_{n-1})$ 相互独立
3. **正态增量**：对于 $s < t$，$B(t) - B(s) \sim N(0, t-s)$
4. **连续性**：样本路径 $t \mapsto B(t)$ 几乎 surely 连续

**定义 7.8（一般布朗运动）** 设 $\mu \in \mathbb{R}$，$\sigma > 0$。随机过程
$$X(t) = \mu t + \sigma B(t)$$

称为具有**漂移** $\mu$ 和**扩散系数** $\sigma$ 的**布朗运动**。

### 7.3.2 布朗运动的数字特征

**定理 7.10** 标准布朗运动的期望和协方差为：
$$E[B(t)] = 0, \quad \text{Cov}(B(s), B(t)) = \min(s, t)$$

**证明**：对于 $s \leq t$，
$$\text{Cov}(B(s), B(t)) = \text{Cov}(B(s), B(s) + (B(t) - B(s))) = \text{Var}[B(s)] = s$$

**定理 7.11** 布朗运动是高斯过程，即任意有限维分布都是多元正态分布。

### 7.3.3 布朗运动的性质

**性质 1（自相似性）** 对于任意 $c > 0$，过程 $\{B(ct), t \geq 0\}$ 与 $\{\sqrt{c}B(t), t \geq 0\}$ 具有相同的分布。

**性质 2（时间反演）** 过程 $\{tB(1/t), t > 0\}$（定义 $0 \cdot B(\infty) = 0$）也是标准布朗运动。

**性质 3（鞅性）** 标准布朗运动是鞅：
$$E[B(t) | \mathcal{F}_s] = B(s), \quad s < t$$

其中 $\mathcal{F}_s$ 是到时间 $s$ 为止的信息。

**定理 7.12（不可微性）** 布朗运动的样本路径几乎 surely 处处不可微。

**定理 7.13（二次变差）** 对于区间 $[0, t]$ 的划分 $0 = t_0 < t_1 < \cdots < t_n = t$，当 $\max(t_i - t_{i-1}) \to 0$ 时：
$$\sum_{i=1}^n (B(t_i) - B(t_{i-1}))^2 \to t \quad \text{(in } L^2\text{)}$$

这记为 $dB(t)^2 = dt$，是随机微积分的基础。

## 7.4 布朗运动的推广

### 7.4.1 多维布朗运动

**定义 7.9（多维标准布朗运动）** 随机过程 $\{\mathbf{B}(t) = (B_1(t), \ldots, B_d(t)), t \geq 0\}$ 称为**d维标准布朗运动**，如果：

1. $B_1(t), \ldots, B_d(t)$ 是独立的标准布朗运动
2. 每个分量满足标准布朗运动的定义

**协方差矩阵**：
$$\text{Cov}(B_i(s), B_j(t)) = \delta_{ij} \min(s, t)$$

### 7.4.2 几何布朗运动

**定义 7.10（几何布朗运动）** 随机过程
$$S(t) = S(0) \exp\left(\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma B(t)\right)$$

称为**几何布朗运动**，其中 $\mu$ 是漂移率，$\sigma$ 是波动率。

几何布朗运动在金融数学中广泛应用（Black-Scholes模型），也可用于建模机器人某些参数的随机增长。

### 7.4.3 布朗桥

**定义 7.11（布朗桥）** 固定 $T > 0$ 和 $a, b \in \mathbb{R}$，**布朗桥**是从 $(0, a)$ 到 $(T, b)$ 的布朗运动：
$$B^0(t) = a + \frac{t}{T}(b - a) + B(t) - \frac{t}{T}B(T), \quad 0 \leq t \leq T$$

布朗桥满足 $B^0(0) = a$ 和 $B^0(T) = b$。

### 7.4.4 在机器人中的应用

**例 7.3（传感器噪声建模）** 连续时间系统中，传感器测量噪声常用布朗运动建模。设真实状态为 $x(t)$，测量值为：
$$z(t) = x(t) + \sigma B(t)$$

**例 7.4（随机游走模型）** 机器人在搜索任务中的随机运动可以用布朗运动近似，特别是在没有明确目标时的探索行为。

**例 7.5（粒子扩散）** 多机器人系统中，信息或物质的扩散过程可以用布朗运动建模。

## 7.5 本章小结

本章介绍了两种重要的连续时间随机过程：

1. **泊松过程**：
   - 计数过程，事件独立随机发生
   - 到达时间间隔服从指数分布
   - 可推广到非齐次泊松过程

2. **布朗运动**：
   - 连续时间、连续状态的随机过程
   - 样本路径连续但不可微
   - 高斯过程，具有独立增量
   - 可推广到多维、几何布朗运动、布朗桥等

这些随机过程在机器人传感器建模、不确定性分析、随机控制等领域有重要应用。

## 7.6 参考文献

1. Ross, S. M. (2014). *Introduction to Probability Models* (11th ed.). Academic Press.
2. Karlin, S., & Taylor, H. M. (1975). *A First Course in Stochastic Processes* (2nd ed.). Academic Press.
3. Øksendal, B. (2003). *Stochastic Differential Equations* (6th ed.). Springer.
4. Durrett, R. (2019). *Probability: Theory and Examples* (5th ed.). Cambridge University Press.

## 7.7 练习题

1. 设 $N(t)$ 是速率为 $\lambda$ 的泊松过程，计算 $E[N(t)(N(t)-1)]$。

2. 证明泊松过程的到达时间间隔 $T_1, T_2, \ldots$ 相互独立且都服从指数分布。

3. 设 $N(t)$ 是速率为 $\lambda$ 的泊松过程，证明条件分布：
   $$P(N(s) = k | N(t) = n) = \binom{n}{k} \left(\frac{s}{t}\right)^k \left(1 - \frac{s}{t}\right)^{n-k}, \quad s < t$$
   即在给定 $N(t) = n$ 的条件下，$N(s)$ 服从二项分布。

4. 设 $B(t)$ 是标准布朗运动，计算 $E[B(t)^4]$。

5. 证明布朗运动的自相似性：对于 $c > 0$，$\{B(ct), t \geq 0\}$ 与 $\{\sqrt{c}B(t), t \geq 0\}$ 同分布。

6. 设 $X(t) = \mu t + \sigma B(t)$ 是一般布朗运动，计算其特征函数 $E[e^{iuX(t)}]$。

7. 证明几何布朗运动 $S(t)$ 满足随机微分方程：
   $$dS(t) = \mu S(t) dt + \sigma S(t) dB(t)$$

8. 设 $N_1(t)$ 和 $N_2(t)$ 是独立的泊松过程，速率分别为 $\lambda_1$ 和 $\lambda_2$。求第一个事件来自过程 $N_1$ 的概率。
